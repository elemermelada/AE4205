
figure(5)
clf
hold on
axis equal
x = [1	0.659600000000000	0.398300000000000	1	1	0	0	0.289456045726288	0.214323937814063	0.325583334016689	0.282748346895107	0.411467772851280	0.298900365296314	-0.0832562787387129	-0.105449152154276	0.0235925110872834	-0.301029165931171	0.193211275615125	0.0913479512063339	0.165403454700736	0.122470821608036	0.186047619438108	0.161570483940061	0.235124441629303	0.170800208740751	-0.0475750164221217	-0.0602566583738720	0.0134814349070191	-0.172016666246384	0.110406443208643	0.0521988292607622	1	1	1]
plot_planform(x,true)
x = [1.2	0.8600000000000	0.398300000000000	0.95	1	0	0	0.289456045726288	0.214323937814063	0.325583334016689	0.282748346895107	0.411467772851280	0.298900365296314	-0.0832562787387129	-0.105449152154276	0.0235925110872834	-0.301029165931171	0.193211275615125	0.0913479512063339	0.165403454700736	0.122470821608036	0.186047619438108	0.161570483940061	0.235124441629303	0.170800208740751	-0.0475750164221217	-0.0602566583738720	0.0134814349070191	-0.172016666246384	0.110406443208643	0.0521988292607622	1	1	1]
plot_planform(x,false)
ylabel("$x$","FontSize",16,"Interpreter","latex")
xlabel("$y$","FontSize",16,"Interpreter","latex")
legend("Original planform", "", "Optimized planform")

function res = plot_planform(x,light)
    global parameters
    global initial
    b1 = parameters.b1;
    c0 = initial.croot;
    b0 = initial.b2;
    
    color ="blue"
    if (light)
        color = "cyan"
    end
    
    c_root = x(1)*c0;
    taper_1 = x(2);
    taper_2 = x(3);
    b_2 = x(4)*b0;
    sweep_2 = x(5)*initial.sweep2;
    
    pgon = polyshape([0,0,b1,b1],[0,c_root,c_root*taper_1,0]);
    plot(pgon, FaceColor=color)
    
    pgon = polyshape([b1,b1,b1+b_2,b1+b_2],[0,c_root*taper_1,c_root*taper_1-b_2*tand(sweep_2),c_root*taper_1-b_2*tand(sweep_2)-c_root*taper_1*taper_2]);
    plot(pgon, FaceColor=color)
    
    xlim([0,18])
    res = 0;
end